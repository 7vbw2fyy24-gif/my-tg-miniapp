<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Отправка номера</title>
    <!-- Подключаем официальный скрипт Telegram -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .container {
            max-width: 320px;
            width: 100%;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }
        p {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999999);
            margin-bottom: 25px;
        }
        .phone-input {
            width: 100%;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--tg-theme-hint-color, #dddddd);
            font-size: 18px;
            box-sizing: border-box;
            text-align: center;
            margin-bottom: 20px;
            background-color: var(--tg-theme-secondary-bg-color, #f4f4f4);
            color: var(--tg-theme-text-color, #000000);
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Отправка номера</h1>
        <p>Пожалуйста, введите ваш номер телефона. Администратор свяжется с вами в чате бота.</p>
        <input type="tel" id="phone-input" class="phone-input" placeholder="+7 (999) 123-45-67">
    </div>

    <script>
        // Инициализируем приложение Telegram
        const tg = window.Telegram.WebApp;

        // Получаем элементы страницы
        const phoneInput = document.getElementById('phone-input');
        
        // Настраиваем главную кнопку Telegram
        tg.MainButton.text = "Отправить номер";
        tg.MainButton.color = "#31B545"; // Зеленый цвет кнопки

        // Функция, которая будет вызываться при нажатии на главную кнопку
        const onMainButtonClick = () => {
            const phoneNumber = phoneInput.value.trim();

            // Простая проверка, что поле не пустое
            if (phoneNumber.length < 10) {
                tg.showAlert("Пожалуйста, введите корректный номер телефона.");
                return;
            }

            // Формируем объект с данными для отправки в бота
            const dataToSend = {
                type: "new_number_submission",
                phone: phoneNumber
            };

            // Отправляем данные в бот и закрываем приложение
            tg.sendData(JSON.stringify(dataToSend));
        };

        // Вешаем обработчик на событие клика по главной кнопке
        tg.onEvent('mainButtonClicked', onMainButtonClick);

        // Показываем/скрываем главную кнопку в зависимости от того, есть ли что-то в поле ввода
        phoneInput.addEventListener('input', () => {
            if (phoneInput.value.trim().length > 0) {
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        });
        
        // Расширяем приложение на всю высоту
        tg.expand();
    </script>

</body>
</html>